

[TOC]



#### 1. 说一下OSI七层模型 & TCP/IP四层模型 & 五层协议

![](pics/osi7.png)



##### 1.1 五层协议

- **应用层** ：为特定应用程序提供数据传输服务，例如 HTTP、DNS 等。数据单位为报文。
- **运输层** ：提供的是进程间的通用数据传输服务。由于应用层协议很多，定义通用的运输层协议就可以支持不断增多的应用层协议。运输层包括两种协议：
  - 传输控制协议 TCP，提供面向连接、可靠的数据传输服务，数据单位为报文段；
  - 用户数据报协议 UDP，提供无连接、尽最大努力的数据传输服务，数据单位为用户数据报。
  - TCP 主要提供完整性服务，UDP 主要提供及时性服务。
- **网络层** ：为主机间提供数据传输服务，而运输层协议是为主机中的进程提供服务。网络层把运输层传递下来的报文段或者用户数据报封装成分组。
- **数据链路层 ：网络层针对的还是主机之间的数据传输服务，而主机之间可以有很多链路，链路层协议就是为同一链路的节点提供服务。数据链路层把网络层传来的分组封装成帧。
- **物理层** ：考虑的是怎样在传输媒体上传输数据比特流，而不是指具体的传输媒体。物理层的作用是尽可能屏蔽传输媒体和通信手段的差异，使数据链路层感觉不到这些差异。



##### 1.2 ISO七层模型中表示层和会话层功能是什么？

- **表示层** ：数据压缩、加密以及数据描述。这使得应用程序不必担心在各台主机中表示/存储的内部格式不同的问题。 

- **会话层** ：建立会话，如session认证、断点续传。

  

- 说明：五层协议没有表示层和会话层，而是将这些功能留给应用程序开发者处理。



##### 1.3 数据在各层之间的传递过程

在向下的过程中，需要添加下层协议所需要的首部或者尾部，而在向上的过程中不断拆开首部和尾部。

路由器只有下面三层协议，因为路由器位于网络核心中，不需要为进程或者应用程序提供服务，因此也就不需要运输层和应用层。

<div align="center"> <img src="pics/transfer.jpg" width="500"/> </div><br>



##### 1.4 TCP/IP四层模型

它只有四层，相当于五层协议中数据链路层和物理层合并为网络接口层。

现在的 TCP/IP 体系结构不严格遵循 OSI 分层概念，应用层可能会直接使用 IP 层或者网络接口层。


<div align="center"> <img src="pics/tcp_ip_4.png" width="500"/> </div><br>




TCP/IP 协议族是一种沙漏形状，中间小两边大，IP 协议在其中占用举足轻重的地位。 

<div align="center"> <img src="pics/tcp_ip_protocol_family.png" width="500"/> </div><br>











-----------------------------------------这是一条整理的分割线----------------------------------------------





#### 3. TCP和UDP的区别？



#### 4. TCP三次握手？那四次挥手呢？如何保障可靠传输

前置知识：

```
三次握手：three times handshake；three-way handshake

SYN（Synchronize，译：同步）是该协议中的一个标志位。如果该位被置为1，则表示这个报文是一个请求建立连接的报文。
ACK（Acknowledgement，译：确认）也是该协议的一个标志位。如果该位被置为1，则表示这个报文是一个用于确认的报文。
seq(sequence number，序列号)
ack（Acknowledgement Number，确认编号）
```



##### 三次握手

<div align="center"> <img src="pics/tcp3.png" width="500"/> </div><br>


假设 A 为客户端，B 为服务器端。

- 首先 B 处于 LISTEN（监听）状态，等待客户的连接请求。
- A 向 B 发送连接请求报文段，SYN=1，ACK=0，选择一个初始的序号 x。
- B 收到连接请求报文段，如果同意建立连接，则向 A 发送连接确认报文段，SYN=1，ACK=1，确认号为 x+1，同时也选择一个初始的序号 y。
- A 收到 B 的连接确认报文段后，还要向 B 发出确认，确认号为 y+1，序号为 x+1。
- B 收到 A 的确认后，连接建立。



**三次握手的原因**

​	第三次握手是为了防止失效的连接请求到达服务器，让服务器错误打开连接。

​	失效的连接请求是指：客户端发送的连接请求在网络中滞留，客户端因为没及时收到服务器端发送的连接确认，因此就重新发送了连接请求。滞留的连接请求并不是丢失，之后还是会到达服务器。如果不进行第三次握手，那么服务器会误认为客户端重新请求连接，然后打开了连接。但是并不是客户端真正打开这个连接，因此客户端不会给服务器发送数据，这个连接就白白浪费了。



##### 四次挥手

<div align="center"> <img src="pics/tcp4.jpg" width="500"/> </div><br>





以下描述不讨论序号和确认号，因为序号和确认号的规则比较简单。并且不讨论 ACK，因为 ACK 在连接建立之后都为 1。

- A 发送连接释放报文段，FIN=1。
- B 收到之后发出确认，此时 TCP 属于半关闭状态，B 能向 A 发送数据但是 A 不能向 B 发送数据。
- 当 B 不再需要连接时，发送连接释放请求报文段，FIN=1。
- A 收到后发出确认，进入 TIME-WAIT 状态，等待 2 MSL 时间后释放连接。
- B 收到 A 的确认后释放连接。

**四次挥手的原因**

客户端发送了 FIN 连接释放报文之后，服务器收到了这个报文，就进入了 CLOSE-WAIT 状态。这个状态是为了让服务器端发送还未传送完毕的数据，传送完毕之后，服务器会发送 FIN 连接释放报文。

**TIME_WAIT**

客户端接收到服务器端的 FIN 报文后进入此状态，此时并不是直接进入 CLOSED 状态，还需要等待一个时间计时器设置的时间 2MSL。这么做有两个理由：

- 确保最后一个确认报文段能够到达。如果 B 没收到 A 发送来的确认报文段，那么就会重新发送连接释放请求报文段，A 等待一段时间就是为了处理这种情况的发生。
- 等待一段时间是为了让本连接持续时间内所产生的所有报文段都从网络中消失，使得下一个新的连接不会出现旧的连接请求报文段。



**如何保证可靠传输**

- 数据包校验 
- 超时重传机制 
- 应答机制 
- 对失序数据包重排序 
- TCP还能提供流量控制 









参考：[TCP的三次握手与四次挥手（详解+动图） - CSDN博客](https://blog.csdn.net/qzcsu/article/details/72861891)



#### 为什么TCP连接需要三次握手，两次不可以吗，为什么【阿里面经OneNote】 

- 为了防止已失效的连接请求报文段突然又传送到了服务端，因而产生错误。 
- 例子 
  - “已失效的连接请求报文段”的产生在这样一种情况下：client发出的第一个连接请求报文段并没有丢失，而是在某个网络结点长时间的滞留了，以致延误到连接释放以后的某个时间才到达server。本来这是一个早已失效的报文段。但server收到此失效的连接请求报文段后，就误认为是client再次发出的一个新的连接请求。于是就向client发出确认报文段，同意建立连接。假设不采用“三次握手”，那么只要server发出确认，新的连接就建立了。由于现在client并没有发出建立连接的请求，因此不会理睬server的确认，也不会向server发送数据。但server却以为新的运输连接已经建立，并一直等待client发来数据。这样，server的很多资源就白白浪费掉了。采用“三次握手”的办法可以防止上述现象发生。例如刚才那种情况，client不会向server的确认发出确认。server由于收不到确认，就知道client并没有要求建立连接。” 





#### 5. 一个网络请求的过程





#### 6. HTTP无状态协议 

​	HTTP无状态协议，是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。 





#### 7. Web攻击基础

##### 跨站脚本攻击XSS

##### 跨站请求伪造CSRF

##### SQL注入攻击

##### 拒绝服务攻击Dos



XSS跨站脚本攻击 - 那一叶随风 - 博客园
https://www.cnblogs.com/phpstudy2015-6/p/6767032.html#_label0



SQL注入攻击





#### 8. 什么是短连接和长连接



#### 9. HTTPS加密认证原理



#### 10. SSL连接建立过程

图解SSL/TLS协议 - 阮一峰的网络日志
http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html



#### 11. HTTP2.0原理解析



#### 12. cookies和session的区别



#### 13. GET和POST的区别



#### 14. HTTP状态



#### 15. HTTP方法



#### 16. 请求和响应报文



#### 17. HTTP和HTTPS的区别【阿里面经OneNote】

- http是HTTP协议运行在TCP之上。所有传输的内容都是明文，客户端和服务器端都无法验证对方的身份。 
- https是HTTP运行在SSL/TLS之上，SSL/TLS运行在TCP之上。所有传输的内容都经过加密，加密采用对称加密，但对称加密的密钥用服务器方的证书进行了非对称加密。此外客户端可以验证服务器端的身份，如果配置了客户端验证，服务器方也可以验证客户端的身份。 
- https协议需要到ca申请证书，一般免费证书很少，需要交费。 
- http是超文本传输协议，信息是明文传输，https 则是具有安全性的ssl加密传输协议 
- http和https使用的是完全不同的连接方式用的端口也不一样,前者是80,后者是443。 
- http的连接很简单,是无状态的 
- HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议 要比http协议安全 





#### 18. 如果客户端不断的发送请求连接会怎样？【阿里面经OneNote】 

- 服务器端回为每个请求创建一个链接，然后向client端发送创建链接时的回复，然后进行等待客户端发送第三次握手数据包，这样会白白浪费资源 
- DDos攻击 （分布式拒绝服务）

简单的说就是想服务器发送链接请求，首先进行 

第一步：客户端向服务器端发送连接请求数据包（1） 

第二步：服务器向客户端回复连接请求数据包（2），然后服务器等待客户端发送tcp/ip链接的第三步数据包(3) 

第三步：如果客户端不向服务器端发送最后一个数据包(3)，则服务器须等待30s到2min中才能将此链接进行关闭。当大量的请求只进行到第二步，而不进行第三步，服务器又大量的资源等待第三个数据包。则造成DDos攻击。 

 

- DDos预防(没有根治的办法，除非不用TCP/IP链接)、 
  - 确保服务器的系统文件是最新版本，并及时更新系统补丁 
  - 关闭不必要的服务 
  - 限制同时打开SYN的半连接数目 
  - 缩短SYN半连接的time out时间 
  - 正确设置防火墙 
  - 禁止对主机的非开放服务的访问 
  - 限制特定IP短地址的访问 
  - 启用防火墙的防DDos的属性 
  - 严格限制对外开放的服务器的向外访问 
  - 运行端口映射程序祸端口扫描程序，要认真检查特权端口和非特权端口。 
  - 认真检查网络设备和主机/服务器系统的日志。只要日志出现漏洞或是时间变更，那这台机器就可能遭到了攻击。 
  - 限制在防火墙外与网络文件共享。这样会给黑客截取系统文件的机会，主机的信息暴露给黑客，无疑是给了对方入侵的机会。 

#### 问：那怎么知道连接是恶意的呢？可能是正常连接？【阿里面经OneNote】 

#### GET和POST的区别？【阿里面经OneNote】 

- GET 被强制服务器支持 
- 浏览器对URL的长度有限制，所以GET请求不能代替POST请求发送大量数据 
- GET请求发送数据更小 
- GET请求是不安全的 
- GET请求是幂等的 
- POST请求不能被缓存 
- POST请求相对GET请求是「安全」的 

 

- 在以下情况中，请使用 POST 请求： 

1. 无法使用缓存文件（更新服务器上的文件或数据库） 

2. 向服务器发送大量数据（POST 没有数据量限制） 

3. 发送包含未知字符的用户输入时，POST 比 GET 更稳定也更可靠 

4.post比Get安全性更高 

 

#### TCP和UDP区别？如何改进TCP【阿里面经OneNote】 

- TCP和UDP区别 
  - UDP 是无连接的，即发送数据之前不需要建立连接。 
  - UDP 使用尽最大努力交付，即不保证可靠交付，同时也不使用拥塞控制。 
  - UDP 是面向报文的。UDP 没有拥塞控制，很适合多媒体通信的要求。 
  - UDP 支持一对一、一对多、多对一和多对多的交互通信。 
  - UDP 的首部开销小，只有 8 个字节。 
  - TCP 是面向连接的运输层协议。 
  - 每一条 TCP 连接只能有两个端点(endpoint)，每一条 TCP 连接只能是点对点的（一对一）。 
  - TCP 提供可靠交付的服务。 
  - TCP 提供全双工通信。 
  - TCP是面向字节流。   
  - 首部最低20个字节。 
- TCP加快传输效率的方法 
  - 采取一块确认的机制 





#### 滑动窗口算法？【阿里面经OneNote】  

<http://coolshell.cn/articles/11609.html> 

 

#### TCP的拥塞处理 – Congestion Handling【阿里面经OneNote】 

1）慢启动，2）拥塞避免，3）拥塞发生，4）快速恢复。 





#### 从输入网址到获得页面的过程【阿里面经OneNote】 

- 查询DNS，获取域名对应的IP地址 
  - 浏览器搜索自身的DNS缓存 
  - 搜索操作系统的DNS缓存 
  - 读取本地的HOST文件 
  - 发起一个DNS的系统调用 
    - 宽带运营服务器查看本身缓存 
    - 运营商服务器发起一个迭代DNS解析请求 
- 浏览器获得域名对应的IP地址后，发起HTTP三次握手 
- TCP/IP连接建立起来后，浏览器就可以向服务器发送HTTP请求了 
- 服务器接受到这个请求，根据路径参数，经过后端的一些处理生成HTML页面代码返回给浏览器 
- 浏览器拿到完整的HTML页面代码开始解析和渲染，如果遇到引用的外部[js](http://lib.csdn.net/base/javascript)，CSS,图片等静态资源，它们同样也是一个个的HTTP请求，都需要经过上面的步骤 
- 浏览器根据拿到的资源对页面进行渲染，最终把一个完整的页面呈现给用户 



https://www.nowcoder.com/discuss/61958





#### URL、URI、URN



# 一、计算机网络 

  **基础部分**  

1.    TCP报头格式    
2.    UDP报头格式    
3.    TCP/UDP区别（不仅是宏观上的，最好能根据各自的机制讲解清楚）    
4.    HTTP状态码（最好结合使用场景，比如在缓存命中时使用哪个）    
5.    HTTP协议（一些报头字段的作用，如cace-control、keep-alive）    
6.    OSI协议、TCP/IP协议以及每层对应的协议。    
7.    SESSION机制、cookie机制    
8.    TCP三次握手、四次挥手（这个问题真的要回答吐了，不过真的是面试官最喜欢问的，建议每天手撸一遍，而且不只是每次请求的过程，各种FIN_WAIT、TIME_WAIT状态也要掌握）。    
9.    打开网页到页面显示之间的过程（涵盖了各个方面，DNS解析过程，Nginx请求转发、连接建立和保持过程、浏览器内容渲染过程，考虑的越详细越好）。    
10.    http和https区别，https在请求时额外的过程，https是如何保证数据安全的    
11.    IP地址子网划分    
12.    POST和GET区别    
13.    DNS解析过程   

  **深入部分** 

13. TCP如何保证数据的可靠传输的（这个问题可以引申出很多子问题，拥塞控制慢开始、拥塞避免、快重传、滑动窗口协议、停止等待协议、超时重传机制，最好都能掌握） 
14. 地址解析协议ARP 
15. 交换机和路由器的区别







IP地址+端口 = 套接字







## 参考资料

[OSI 七层参考模型-极客学院（4课时，47分钟）](http://www.jikexueyuan.com/course/1400.html)
